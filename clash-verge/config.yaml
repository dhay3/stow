# Do not use that configuration as an extend config or extend script when a profile has been
# selected that the profile's subscription url is in the $.proxy-provider.url list. If so the proxy
# nodes will be duplicated in proxies panel in Clash Verge Rev, Create a new local profile which
# contains this configuration and selected it. Or add a blank local profile to avoid it
#
# meta https://wiki.metacubex.one/config/
# emoji wiki https://emojis.wiki
# ISO 3166 https://en.wikipedia.org/wiki/List_of_ISO_3166_country_codes


#>>> Yaml Aliases Start >>>
gneral-options:
  healthCheck: &healthCheck { url: http://www.gstatic.com/generate_204, lazy: true, interval: 600, timeout: 3000 }

proxy-providers-options:
  proxyProvidersCommon: &proxyProvidersCommon
    type: http
    interval: 3600
    health-check:
      enable: true
      <<: *healthCheck

proxy-groups-options:
  proxyGroupsCommon: &proxyGroupsCommon
    <<: *healthCheck
    max-failed-times: 3
  proxyGroupsInclude: &proxyGroupsInclude
    include-all: true
    #include-all-proxies: false
    #include-all-providers: false
    <<: *proxyGroupsCommon
  proxyGroupsUse: &proxyGroupsUse
    use:
      - sub1
    <<: *proxyGroupsCommon
  proxyGroup: &proxyGroup { proxies: [üá¶üá∑ AR,üá¶üá∫ AU,üáßüá∑ BR,üá®üá¶ CA,üá©üá™ DE,üá™üá¨ EG,üá´üá∑ FR,üá≠üá∞ HK,üáÆüá© ID,üáÆüá≥ IN,üáØüáµ JP,üá∞üáµ KP,üá∞üá∑ KR,üá≤üá¥ MA,üá≤üáΩ MX,üá≤üáæ MY,üá≥üá¨ NG,üá≥üá± NL,üá≥üáø NZ,üáµüá≠ PH,üáµüá∞ PK,üá∑üá∫ RU,üá∏üá¶ SA,üá∏üá¨ SG,üáπüá≠ TH,üáπüá∑ TR,üáπüáº TW,üá∫üá¶ UA,üá¨üáß UK,üá∫üá∏ US,üáªüá≥ VN] }
  proxyGroupCombined: &proxyGroupCombined { proxies: [üåê DIRECT,üö´ REJECT,ü´¥ MANUAL,üßÖ TOR,üá¶üá∑ AR,üá¶üá∫ AU,üáßüá∑ BR,üá®üá¶ CA,üá©üá™ DE,üá™üá¨ EG,üá´üá∑ FR,üá≠üá∞ HK,üáÆüá© ID,üáÆüá≥ IN,üáØüáµ JP,üá∞üáµ KP,üá∞üá∑ KR,üá≤üá¥ MA,üá≤üáΩ MX,üá≤üáæ MY,üá≥üá¨ NG,üá≥üá± NL,üá≥üáø NZ,üáµüá≠ PH,üáµüá∞ PK,üá∑üá∫ RU,üá∏üá¶ SA,üá∏üá¨ SG,üáπüá≠ TH,üáπüá∑ TR,üáπüáº TW,üá∫üá¶ UA,üá¨üáß UK,üá∫üá∏ US,üáªüá≥ VN,üè≥Ô∏è‚Äçüåà FF] }

rule-providers-options:
  ruleProvidersCommon: &ruleProvidersCommon { type: http, format: yaml, interval: 10368000 }
#<<< Yaml Aliases End <<<

#>>> Genernal Configuration Start >>>
# Do not use default port for security concern
bind-address: '*'
mixed-port: 37897
redir-port: 37898
tproxy-port: 37899
external-controller: 0.0.0.0:9090
log-level: silent
allow-lan: false
ipv6: false
unified-delay: true
tcp-concurrent: true
keep-alive-interval: 300
global-client-fingerprint: random
global-ua: clash.meta
profile:
  store-selected: true
  store-fake-ip: false
#<<< Genernal Configuration End <<<

#>>> GEO Configuration Start >>>
geodata-loader: standard
geo-auto-update: true
geo-update-interval: 168
geox-url:
  geoip: https://hub.gitmirror.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geoip.dat
  geosite: https://hub.gitmirror.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geosite.dat
  mmdb: https://hub.gitmirror.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/country.mmdb
  asn: https://hub.gitmirror.com/https://github.com/xishang0128/geoip/releases/download/latest/GeoLite2-ASN.mmdb
#<<< GEO Configuration End <<<

#>>> DNS Configuration Start >>>
# 208.67.220.220 opendns
# 9.9.9.9 quad9
# 1.1.1.1 cloudflare
# 223.5.5.5 alidns
# 119.29.29.29 tencent
dns:
  enable: true
  prefer-h3: false
  ipv6: false
  use-hosts: true
  use-system-hosts: true
  enhanced-mode: fake-ip
  fake-ip-range: 100.64.0.1/10
  fake-ip-filter:
    - geosite:private
    - geosite:cn
    - +.rustdesk.com
  default-nameserver:
    - 223.5.5.5
    - 9.9.9.9
  nameserver-policy:
    geosite:private: system
    geosite:cn: https://223.5.5.5/dns-query#skip-cert-verify=true
    +.rustdesk.com: https://223.5.5.5/dns-query#skip-cert-verify=true
  proxy-server-nameserver:
    - https://9.9.9.9/dns-query#skip-cert-verify=true
  direct-nameserver:
    - system
  nameserver:
    - https://223.5.5.5/dns-query#skip-cert-verify=true
  fallback:
    - https://9.9.9.9/dns-query#skip-cert-verify=true
  fallback-filter:
    geoip: true
    geoip-code: CN
#<<< DNS Configuration End <<<

#>>> Domain Sniffing Configuration Start >>>
sniffer:
  enable: true
  sniff:
    HTTP:
      ports: [80]
    TLS:
      ports: [443]
    QUIC:
      ports: [443]
  skip-domain:
    - +.lan
    - +.local
    - +.localhost
#<<< Domain Sniffing Configuration End <<<

#>>> TUN/TAP Configuration Start >>>
tun:
  enable: true
  stack: mixed
  device: meta0
  auto-route: true
  auto-redirect: false
  auto-detect-interface: true
  strict-route: true
  # set auto-redirect to false to enable it
  # uncomment to bypass local DNS nameserver
  route-exclude-address:
    # - 0.0.0.0/8
    # - 10.0.0.0/8
    # - 127.0.0.0/8
    # - 169.254.0.0/16
    # - 172.16.0.0/12
    # - 192.0.0.0/24
    # - 192.0.2.0/24
    # - 192.88.99.0/24
    # - 192.168.0.0/16
    # - 198.18.0.0/15
    # - 198.51.100.0/24
    # - 203.0.113.0/24
    # - 224.0.0.0/3
    # bypass dns for troubleshooting when tun is enabled
    - 119.29.29.29/32
    # bypass rustdesk
    - 209.250.254.15/32
  dns-hijack:
    - any:53
  mtu: 1500
#<<< TUN/TAP Configuration End <<<

#>>> Proxy Providers Configuration Start >>>
# Replace url with your subscription
proxy-providers:
  sub1:
    <<: *proxyProvidersCommon
    url: https://example.org/sub1
    path: ./proxy_providers/sub1.yaml
    proxy: üáØüáµ JP
#<<< Proxy Providers Configuration End <<<

#>>> Proxies Configuration Start >>>
# TUN must be enabled when use the TOR proxy
proxies: [ { name: üßÖ TOR, type: socks5, server: 127.0.0.1, port: 9050, udp: true, ip-version: ipv4 } ]
#<<< Proxies Configuration End <<<

#>>> Proxy Groups(Policy) Configuration Start >>>
proxy-groups:
  - { name: üåê DIRECT, type: select, proxies: [ DIRECT ] }
  - { name: üö´ REJECT, type: select, proxies: [ REJECT ] }
  - { name: üá¶üá∑ AR,<<: *proxyGroupsInclude, type: select, filter: (?i)üá¶üá∑|ÈòøÊ†πÂª∑|argentina }
  - { name: üá¶üá∫ AU,<<: *proxyGroupsInclude, type: select, filter: (?i)üá¶üá∫|Êæ≥Â§ßÂà©‰∫ö|Êæ≥Â§ßÂà©‰∫û|australia }
  - { name: üáßüá∑ BR,<<: *proxyGroupsInclude, type: select, filter: (?i)üáßüá∑|Â∑¥Ë•ø|brazil }
  - { name: üá®üá¶ CA,<<: *proxyGroupsInclude, type: select, filter: (?i)üá®üá¶|Âä†ÊãøÂ§ß|canada }
  - { name: üá©üá™ DE,<<: *proxyGroupsInclude, type: select, filter: (?i)üá©üá™|Âæ∑ÂõΩ|Âæ∑Âúã|ÊüèÊûó|ÊÖïÂ∞ºÈªë|germany }
  - { name: üá™üá¨ EG,<<: *proxyGroupsInclude, type: select, filter: (?i)üá™üá¨|ÂüÉÂèä|egypt }
  - { name: üá´üá∑ FR,<<: *proxyGroupsInclude, type: select, filter: (?i)üá´üá∑|Ê≥ïÂõΩ|Ê≥ïÂúã|Á¶èÂÖ∞ÂÖã|Á¶èËò≠ÂÖã|french }
  - { name: üá≠üá∞ HK,<<: *proxyGroupsInclude, type: select, filter: (?i)üá≠üá∞|È¶ôÊ∏Ø|hongkong }
  - { name: üáÆüá© ID,<<: *proxyGroupsInclude, type: select, filter: (?i)üáÆüá©|Âç∞Â∞º|indonesia }
  - { name: üáÆüá≥ IN,<<: *proxyGroupsInclude, type: select, filter: (?i)üáÆüá≥|Âç∞Â∫¶|india }
  - { name: üáØüáµ JP,<<: *proxyGroupsInclude, type: select, filter: (?i)üáØüáµ|Êó•Êú¨|japan }
  - { name: üá∞üáµ KP,<<: *proxyGroupsInclude, type: select, filter: (?i)üá∞üáµ|ÊúùÈ≤ú|ÊúùÈÆÆ }
  - { name: üá∞üá∑ KR,<<: *proxyGroupsInclude, type: select, filter: (?i)üá∞üá∑|Èü©ÂõΩ|ÈüìÂúã }
  - { name: üá≤üá¥ MA,<<: *proxyGroupsInclude, type: select, filter: (?i)üá≤üá¥|Êæ≥Èó®|Êæ≥ÈñÄ|maco }
  - { name: üá≤üáΩ MX,<<: *proxyGroupsInclude, type: select, filter: (?i)üá≤üáΩ|Â¢®Ë•øÂì•|mexico }
  - { name: üá≤üáæ MY,<<: *proxyGroupsInclude, type: select, filter: (?i)üá≤üáæ|È©¨Êù•Ë•ø‰∫ö|È¶¨‰æÜË•ø‰∫û|malaysia }
  - { name: üá≥üá¨ NG,<<: *proxyGroupsInclude, type: select, filter: (?i)üá≥üá¨|Â∞ºÊó•Âà©‰∫ö|nigeria }
  - { name: üá≥üá± NL,<<: *proxyGroupsInclude, type: select, filter: (?i)üá≥üá±|Ëç∑ÂÖ∞|Ëç∑Ëò≠|netherlands }
  - { name: üá≥üáø NZ,<<: *proxyGroupsInclude, type: select, filter: (?i)üá≥üáø|Êñ∞Ë•øÂÖ∞|Êñ∞Ë•øËò≠|zeeland }
  - { name: üáµüá≠ PH,<<: *proxyGroupsInclude, type: select, filter: (?i)üáµüá≠|Ëè≤ÂæãÂÆæ|Ëè≤ÂæãË≥ì|philippines }
  - { name: üáµüá∞ PK,<<: *proxyGroupsInclude, type: select, filter: (?i)üáµüá∞|Â∑¥Âü∫ÊñØÂù¶|pakistan }
  - { name: üá∑üá∫ RU,<<: *proxyGroupsInclude, type: select, filter: (?i)üá∑üá∫|‰øÑÁΩóÊñØ|‰øÑÁæÖÊñØ|russia }
  - { name: üá∏üá¶ SA,<<: *proxyGroupsInclude, type: select, filter: (?i)üá∏üá¶|Ê≤ôÁâπ|arabia }
  - { name: üá∏üá¨ SG,<<: *proxyGroupsInclude, type: select, filter: (?i)üá∏üá¨|Êñ∞Âä†Âù°|singapore }
  - { name: üáπüá≠ TH,<<: *proxyGroupsInclude, type: select, filter: (?i)üáπüá≠|Ê≥∞ÂõΩ|Ê≥∞Âúã|Thailand }
  - { name: üáπüá∑ TR,<<: *proxyGroupsInclude, type: select, filter: (?i)üáπüá∑|ÂúüËÄ≥ÂÖ∂|turkey }
  - { name: üáπüáº TW,<<: *proxyGroupsInclude, type: select, filter: (?i)üáπüáº|Âè∞Êπæ|Ëá∫ÁÅ£|taiwan }
  - { name: üá∫üá¶ UA,<<: *proxyGroupsInclude, type: select, filter: (?i)üá∫üá¶|‰πåÂÖãÂÖ∞|ÁÉèÂÖãËò≠|ukrainian }
  - { name: üá¨üáß UK,<<: *proxyGroupsInclude, type: select, filter: (?i)üá¨üáß|Ëã±|Ëã±Âúã|england|kingdom|britsh }
  - { name: üá∫üá∏ US,<<: *proxyGroupsInclude, type: select, filter: (?i)üá∫üá∏|ÁæéÂõΩ|ÁæéÂúã|Ë•øÈõÖÂõæ|Ë•øÈõÖÂúñ|Ê¥õÊùâÁü∂|Ê¥õÊùâÁ£Ø|ËâæÊñØÊú¨|america|states|seattle|angeles|ashburn }
  - { name: üáªüá≥ VN,<<: *proxyGroupsInclude, type: select, filter: (?i)üáªüá≥|Ë∂äÂçó|vietnam }
  - { name: üè≥Ô∏è‚Äçüåà FF,<<: *proxyGroupsInclude, type: select, exclude-filter: üßÖ }

  - { name: ü´¥ MANUAL, type: select, proxies: [üåê DIRECT,üö´ REJECT,üßÖ TOR,üá¶üá∑ AR,üá¶üá∫ AU,üáßüá∑ BR,üá®üá¶ CA,üá©üá™ DE,üá™üá¨ EG,üá´üá∑ FR,üá≠üá∞ HK,üáÆüá© ID,üáÆüá≥ IN,üáØüáµ JP,üá∞üáµ KP,üá∞üá∑ KR,üá≤üá¥ MA,üá≤üáΩ MX,üá≤üáæ MY,üá≥üá¨ NG,üá≥üá± NL,üá≥üáø NZ,üáµüá≠ PH,üáµüá∞ PK,üá∑üá∫ RU,üá∏üá¶ SA,üá∏üá¨ SG,üáπüá≠ TH,üáπüá∑ TR,üáπüáº TW,üá∫üá¶ UA,üá¨üáß UK,üá∫üá∏ US,üáªüá≥ VN,üè≥Ô∏è‚Äçüåà FF] }
  - { name: üöò Auto, type: url-test, url: https://www.gstatic.com/generate_204, lazy: true, interval: 3600, timeout: 1000, tolerance: 30, max-failed-times: 3, <<: *proxyGroup }
  - { name: üîô Fallback, type: fallback, url: https://www.gstatic.com/generate_204, lazy: true, interval: 3600, timeout: 3000, max-failed-times: 3, <<: *proxyGroup }
  - { name: üîä ADS, type: select, proxies: [üåê DIRECT,üö´ REJECT,ü´¥ MANUAL] }
  - { name: ü§ñ AI, type: select, <<: *proxyGroupCombined }
  - { name: üçé Apple, type: select, <<: *proxyGroupCombined }
  - { name: üá¨ Google, type: select, <<: *proxyGroupCombined }
  - { name: üß™ YouTube, type: select, <<: *proxyGroupCombined }
  - { name: ü•Ö Netflix, type: select, <<: *proxyGroupCombined }
  - { name: üê≠ Disney, type: select, <<: *proxyGroupCombined }
  - { name: üëå HBO, type: select, <<: *proxyGroupCombined }
  - { name: üßôüèø‚Äç‚ôÄÔ∏è Twitch, type: select, <<: *proxyGroupCombined }
  - { name: üê¶ Twitter, type: select, <<: *proxyGroupCombined }
  - { name: üì≤ Telegram, type: select, <<: *proxyGroupCombined }
  - { name: üöÇ Steam, type: select, <<: *proxyGroupCombined }
  - { name: ü™ü Microsoft, type: select, <<: *proxyGroupCombined }
  - { name: üìà IPinfo, type: select, <<: *proxyGroupCombined }
  - { name: üëÇ Spotify, type: select, <<: *proxyGroupCombined }
  - { name: üÄÑ Manchuria, type: select, <<: *proxyGroupCombined }
  - { name: ü™ú Proxy, type: select, <<: *proxyGroupCombined }
  - { name: üêü Leakage, type: select, <<: *proxyGroupCombined }
#<<< Proxy Groups(Policy) Configuration End <<<

#>>> Rule Providers Configuration Start >>>
# https://github.com/Loyalsoldier/clash-rules
# https://github.com/blackmatrix7/ios_rule_script/tree/master/rule/Clash
#rule-providers:
#  claude:
#    <<: *ruleProvidersCommon
#    behavior: domain
#    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Claude/Claude.yaml
#    path: ./ruleset/Claude.yaml
#<<< Rule Providers Configuration End <<<

#>>> Rules Configuration End >>>
rules:
  - GEOIP,PRIVATE,üåê DIRECT,no-resolve
  - GEOIP,CN,üåê DIRECT,no-resolve
  - IP-CIDR,9.9.9.9/32,üåê DIRECT,no-resolve
  - GEOSITE,category-ads-all,üîä ADS
  - GEOSITE,private,üåê DIRECT
  - DOMAIN-SUFFIX,linux.do,üåê DIRECT
  - DOMAIN-SUFFIX,rustdesk.com,üåê DIRECT
  - PROCESS-PATH-REGEX,.*rustdesk,üåê DIRECT
  - AND,((DOMAIN,hf.co),(DST-PORT,22)),üåê DIRECT
  - DOMAIN,fast.com,üìà IPinfo
  - DOMAIN,check.torproject.org,üìà IPinfo
  - DOMAIN-SUFFIX,myip.la,üìà IPinfo
  - DOMAIN-SUFFIX,ipip.net,üìà IPinfo
  - DOMAIN-SUFFIX,ipinfo.io,üìà IPinfo
  - GEOSITE,speedtest,üìà IPinfo
  - GEOSITE,google,üá¨ Google
  - GEOSITE,youtube,üß™ YouTube
  - GEOSITE,netflix,ü•Ö Netflix
  - GEOSITE,disney,üê≠ Disney
  - GEOSITE,hbo,üëå HBO
  - GEOSITE,openai,ü§ñ AI
  - GEOSITE,anthropic,ü§ñ AI
  - GEOSITE,twitch,üßôüèø‚Äç‚ôÄÔ∏è Twitch
  - GEOSITE,twitter,üê¶ Twitter
  - GEOSITE,telegram,üì≤ Telegram
  - GEOSITE,spotify,üëÇ Spotify
  - GEOSITE,microsoft@cn,üåê DIRECT
  - GEOSITE,microsoft,ü™ü Microsoft
  - GEOSITE,apple@cn,üåê DIRECT
  - GEOSITE,apple,üçé Apple
  - GEOSITE,steam@cn,üåê DIRECT
  - GEOSITE,steam,üöÇ Steam
  - GEOSITE,bilibili,üÄÑ Manchuria
  - GEOSITE,zhihu,üÄÑ Manchuria
  - GEOSITE,douban,üÄÑ Manchuria
  - GEOSITE,smzdm,üÄÑ Manchuria
  - GEOSITE,cn,üåê DIRECT
  - GEOSITE,geolocation-!cn,ü™ú Proxy
  - MATCH,üêü Leakage
#<<< Rules Configuration End <<<
